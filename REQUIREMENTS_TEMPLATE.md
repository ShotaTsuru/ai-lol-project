# 要件定義・テスト駆動開発テンプレート

## 📋 プロジェクト概要

### プロジェクト名
**[プロジェクト名を記入]**

### プロジェクトの目的・背景
**[なぜこの機能が必要か、どんな問題を解決するかを記入]**

### ステークホルダー
- **プロダクトオーナー**: [名前・連絡先]
- **開発者**: [名前・連絡先]
- **エンドユーザー**: [ターゲットユーザーの特徴]

---

## 🎯 機能要件

### 機能概要
**[実装する機能の概要を記入]**

### ユーザーストーリー
```
As a [ユーザーロール]
I want to [やりたいこと]
So that [得られる価値・理由]
```

### 受け入れ条件（Acceptance Criteria）
- [ ] **Given** [前提条件] **When** [アクション] **Then** [期待結果]
- [ ] **Given** [前提条件] **When** [アクション] **Then** [期待結果]
- [ ] **Given** [前提条件] **When** [アクション] **Then** [期待結果]

### 詳細要件
1. **[要件1]**
   - 説明: [詳細説明]
   - 優先度: 高/中/低
   - 実装方針: [技術的アプローチ]

2. **[要件2]**
   - 説明: [詳細説明]
   - 優先度: 高/中/低
   - 実装方針: [技術的アプローチ]

---

## 🏗️ 技術要件

### アーキテクチャ
- **フロントエンド**: Next.js 14 + TypeScript + Tailwind CSS
- **バックエンド**: Go + Gin + GORM
- **データベース**: PostgreSQL + Redis
- **その他**: [必要な技術・ライブラリ]

### パフォーマンス要件
- **応答時間**: [目標値（例：APIは200ms以内）]
- **スループット**: [目標値（例：1000req/sec）]
- **可用性**: [目標値（例：99.9%）]

### セキュリティ要件
- [ ] 認証・認可の実装
- [ ] 入力値検証
- [ ] XSS/CSRF対策
- [ ] [その他セキュリティ要件]

---

## 🧪 テスト戦略

### テストピラミッド
```
        🔺 E2E Tests (Frontend)
       🔺🔺 Integration Tests (Backend)
    🔺🔺🔺🔺 Unit Tests (Backend)
```

### 1. フロントエンド E2E テスト
**目的**: ユーザー体験全体の検証

**テストシナリオ**:
- [ ] **シナリオ1**: [ユーザーの主要な操作フロー]
  - Given: [初期状態]
  - When: [ユーザーアクション]  
  - Then: [期待される結果]

- [ ] **シナリオ2**: [エラーハンドリング]
  - Given: [エラー条件]
  - When: [ユーザーアクション]
  - Then: [適切なエラー表示]

**使用ツール**: Playwright / Cypress
**実行頻度**: CI/CD、リリース前

### 2. バックエンド 単体テスト
**目的**: 個別関数・メソッドの動作検証

**テスト対象**:
- [ ] **Controllers**: HTTPハンドラーのテスト
  ```go
  func TestCreateProject(t *testing.T) {
      // Arrange: テストデータ準備
      // Act: 関数実行
      // Assert: 結果検証
  }
  ```

- [ ] **Services**: ビジネスロジックのテスト
  ```go
  func TestValidateProjectData(t *testing.T) {
      // 正常系・異常系のテストケース
  }
  ```

- [ ] **Models**: データアクセス層のテスト
  ```go
  func TestProjectCRUD(t *testing.T) {
      // データベース操作のテスト
  }
  ```

**使用ツール**: Go標準testing、testify
**カバレッジ目標**: 80%以上

### 3. バックエンド 結合テスト
**目的**: サービス間連携の検証

**テスト対象**:
- [ ] **API結合テスト**: HTTPリクエスト〜レスポンスの完全フロー
- [ ] **データベース結合テスト**: 実際のDBとの連携テスト
- [ ] **外部API結合テスト**: OpenAI APIなど外部サービスとの連携

**使用ツール**: httptest、Docker Test Containers
**実行環境**: テスト専用DB

---

## 🤖 AI実装補助の方針

### AI活用の目的
- [ ] **コード生成の効率化**: 繰り返し処理・ボイラープレートの自動生成
- [ ] **テストケース作成**: エッジケースの洗い出し
- [ ] **コードレビュー**: バグ・改善点の発見
- [ ] **ドキュメント生成**: API仕様書・技術ドキュメントの作成

### AI実装補助のガイドライン
1. **コード品質の維持**
   - AI生成コードでも必ずコードレビューを実施
   - テストファースト（TDD）の原則を守る
   - 既存のコーディング規約に準拠

2. **セキュリティの確保**
   - AI生成コードの脆弱性チェックを必須とする
   - 機密情報がコード内に含まれていないか確認
   - 適切な入力値検証を実装

3. **保守性の向上**
   - 理解しやすいコード構造を維持
   - 適切なコメント・ドキュメント作成
   - 依存関係の最小化

### AI活用の制限事項
- [ ] 機密データの学習利用は禁止
- [ ] 生成されたコードは必ず人間による検証を経る
- [ ] ライセンス・著作権の確認を必須とする

---

## 📝 実装チェックリスト

### 開発開始前
- [ ] 要件定義の関係者レビュー完了
- [ ] テストケース設計完了
- [ ] 技術的な実装方針の合意
- [ ] 開発環境の準備完了

### TDD サイクル
各機能実装時に以下を繰り返す：

1. **🔴 Red**: テストを書く（失敗することを確認）
   - [ ] 単体テストケース作成
   - [ ] 結合テストケース作成（必要に応じて）
   
2. **🟢 Green**: 最小限の実装でテストを通す
   - [ ] 機能の実装
   - [ ] テストが成功することを確認
   
3. **🔵 Refactor**: コードを改善する
   - [ ] コードクリーンアップ
   - [ ] パフォーマンス最適化
   - [ ] 重複コード除去

### 実装完了時
- [ ] 全てのテストが成功
- [ ] コードカバレッジが目標値を達成
- [ ] E2Eテストが成功
- [ ] セキュリティチェック完了
- [ ] パフォーマンステスト完了
- [ ] ドキュメント更新完了

---

## 🚀 デプロイ・リリース

### リリース判定基準
- [ ] 全ての受け入れ条件をクリア
- [ ] 全テストスイートが成功
- [ ] セキュリティ監査完了
- [ ] パフォーマンス要件を満たす
- [ ] ドキュメント整備完了

### ロールバック計画
- [ ] データベースマイグレーションの巻き戻し手順
- [ ] アプリケーションの前バージョンへの復旧手順
- [ ] ユーザーへの影響範囲・通知方法

---

## 📊 成功指標・KPI

### 技術指標
- **テストカバレッジ**: [目標値]%
- **バグ検出率**: [目標値]個/機能
- **応答時間**: [目標値]ms
- **可用性**: [目標値]%

### ビジネス指標
- **ユーザー満足度**: [測定方法・目標値]
- **機能利用率**: [目標値]%
- **[その他の指標]**: [目標値]

---

## 📅 スケジュール

| フェーズ | 期間 | 主な作業 | 成果物 |
|---------|------|---------|--------|
| 要件定義 | [期間] | [作業内容] | [成果物] |
| 設計 | [期間] | [作業内容] | [成果物] |
| 実装 | [期間] | [作業内容] | [成果物] |
| テスト | [期間] | [作業内容] | [成果物] |
| デプロイ | [期間] | [作業内容] | [成果物] |

---

## 🔗 関連ドキュメント・リンク

- [API仕様書](./api-specs.md)
- [データベース設計書](./database-design.md)
- [UI/UXデザイン](./design-system.md)
- [デプロイ手順書](./deployment-guide.md)

---

## 📝 変更履歴

| 日付 | バージョン | 変更内容 | 担当者 |
|------|-----------|----------|--------|
| YYYY-MM-DD | v1.0.0 | 初版作成 | [担当者名] |

---

## ✅ レビュー・承認

- [ ] **プロダクトオーナー承認**: [名前・日付]
- [ ] **技術責任者承認**: [名前・日付]
- [ ] **QA承認**: [名前・日付]
